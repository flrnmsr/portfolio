!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.gatsbyStoryblokImage={})}(this,function(t){var e=/^\/\/a.storyblok.com\/f\/[0-9]+\/[0-9]+x[0-9]+\/[A-Za-z0-9]+\/[\S]+\.[a-z]+/;function a(t){var a=null,n=null;if("string"==typeof t&&(a=t),"object"==typeof t&&(a=t.image,n=t.base64?t.base64:null),!(a=e.test(a)?a:null))return!1;var i=a.replace("//a.storyblok.com/",""),r=i.split("/"),s=r[4],o=r[2].split("x").map(function(t){return parseInt(t,10)}),u=o[0],l=o[1];return{originalPath:i,extension:s.split(".")[1],metadata:{dimensions:{width:u,height:l,aspectRatio:u/l},lqip:n}}}var n="https://img2.storyblok.com",i=[1,1.5,2,3],r=[.25,.5,1,1.5,2,3],s={quality:100,smartCrop:!0,format:null,fill:null,toFormat:null,base64:null,useBase64:!0},o=Object.assign({},s,{maxWidth:800,maxHeight:null}),u=Object.assign({},s,{width:400,height:null});function l(t){var e=t.includes("filters:format(webp)"),a=/[a-f0-9]+-\d+x\d+\.webp/.test(t);return e||a}function c(t,e){var a=e.width,i=e.height,r=e.smartCrop,s=e.quality,o=e.format,u=e.fill,l=t.split("."),c=n;a&&i&&(c+="/"+a+"x"+i),r&&(c+="/smart");var h=[s&&"quality:("+s+")",o&&o!==l[1]&&"format:("+o+")",u&&"fill:("+u+")"];return(h=h.filter(function(t){return!0===Boolean(t)})).length>0&&(c+=function(t){return t.reduce(function(t,e,a){return t+":"+e},"/filters")}(h)),c+"/"+t}t.getFixedGatsbyImage=function(t,e){void 0===e&&(e={});var n=a(t);if(!n)return null;var r=Object.assign({},u,e),s=r.width,o=r.height,h=r.base64,f=r.useBase64,p=n.metadata,b=p.dimensions,d=p.lqip,m=n.originalPath,g=b.aspectRatio;r.height&&(g=s/r.height);var w=null;r.toFormat?w=r.toFormat:l(m)&&(w="jpg");var j=i.map(function(t){return Math.round(s*t)}).filter(function(t){return t<b.width}).reduce(function(t,e,a){var n=i[a]+"x",s=Math.round(e/g),o=Object.assign({},r,{width:e,height:s}),u=c(m,Object.assign({},o,{format:"webp"})),l=c(m,Object.assign({},o,w&&{format:w}));return t.webp.push(u+" "+n),t.base.push(l+" "+n),t},{webp:[],base:[]}),v=Math.round(o||s/g),x=Object.assign({},r,{width:s,height:v}),y=c(m,Object.assign({},x,w&&{format:w})),O=c(m,Object.assign({},x,{format:"webp"}));return{base64:f?h||d:null,aspectRatio:g,width:Math.round(s),height:v,src:y,srcWebp:O,srcSet:j.base.join(",\n")||null,srcSetWebp:j.webp.join(",\n")||null}},t.getFluidGatsbyImage=function(t,e){void 0===e&&(e={});var n=a(t);if(!n)return null;var i=Object.assign({},o,e),s=i.maxWidth,u=i.base64,h=i.useBase64,f=n.metadata,p=f.dimensions,b=f.lqip,d=n.originalPath,m=p.aspectRatio;i.maxHeight&&(m=s/i.maxHeight);var g=i.maxHeight||Math.round(s/p.aspectRatio),w=null;i.toFormat?w=i.toFormat:l(d)&&(w="jpg");var j=i.sizes||"(max-width: "+s+"px) 100vw, "+s+"px",v=r.map(function(t){return Math.round(s*t)}).filter(function(t){return t<p.width}).concat(p.width).filter(function(t){return t<p.width}).reduce(function(t,e){var a={width:e,height:Math.round(e/m)},n=c(d,Object.assign({},i,a,{format:"webp"})),r=c(d,Object.assign({},i,a,{format:w}));return t.webp.push(n+" "+e+"w"),t.base.push(r+" "+e+"w"),t},{webp:[],base:[]}),x={width:s,height:g},y=c(d,Object.assign({},i,x,{format:w})),O=c(d,Object.assign({},i,x,{format:"webp"}));return{base64:h?u||b:null,aspectRatio:m,src:y,srcWebp:O,srcSet:v.base.join(",\n")||null,srcSetWebp:v.webp.join(",\n")||null,sizes:j}}});
//# sourceMappingURL=index.umd.js.map
